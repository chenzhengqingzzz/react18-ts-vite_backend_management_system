# React18+TypeScript+Vite 的通用后台管理系统

Ant Design of React官网：https://ant.design/docs/react/introduce-cn

# 一、创建项目

```shell
npm init vite
Project name: lege-management
select a framework: react
select a variant: react-ts
```

打开package.json,参考以下个模块版本：

`src/package.json`

```json
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-redux": "^7.2.8",
    "react-router-dom": "^6.3.0",
    "redux": "^4.1.2",
  },
```

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230624150347234.png" alt="image-20230624150347234" style="zoom:67%;" />

# 二、项目目录初始化

`src/main.tsx`修改成：

```tsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App.tsx'

ReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
)
```

`src/App.tsx`修改成：

```tsx
import { useState } from 'react'

function App() {
  const [count, setCount] = useState(0)

  return (
    <div className='App'>
      顶级组件
    </div>
  )
}

export default App
```

# 三、样式初始化

我们可以用`reset-css`这个库干净利落地去除默认样式，更适合在企业中使用

执行命令安装`reset-css`：

```shell
npm i reset-css
```

`src/main.tsx`引入`reset-css`

```tsx
import React from 'react'
import ReactDOM from 'react-dom/client'
// 全局引入reset-css 样式初始化一般放在最前
import 'reset-css'
// UI框架的样式

// 组件的样式

import App from './App.tsx'
```

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230623181647455.png" alt="image-20230623181647455" style="zoom:67%;" />

# 四、SCSS的安装和初步使用

安装sass：

```shell
# 安装sass vite中很方便 loader这些都不用自己配置 只需要安装好即可使用
npm i --save-dev sass
```

src新建样式文件夹：

`src/assets/styles`

```scss
$color: pink;
body {
    background-color: $color;
    // 禁止文字选中
    user-select: none;
}

img {
    // 禁止拖动图片
    -webkit-user-drag: none;
}
```

在入口文件引入这个全局样式

`src/main.tsx`

```tsx
// 全局样式
import './assets/styles/global.scss'
```

我们在全局样式里设置了无法拖动图片 无法选中文字等一系列操作 并且设置了背景图片

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230623183026031.png" alt="image-20230623183026031" style="zoom:67%;" />

# 五、配置项目路径别名

## 5.1 路径别名的配置

目前ts对@指向src目录的提示是不支持的，vite默认也是不支持的

所以需要手动配置@符号的指向

`src/vite.config.ts`

```ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path';

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src')
    }
  }
})
```

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230623184413734.png" alt="image-20230623184413734" style="zoom:67%;" />

这时候引入path模块会爆红，但其实我们已经已经有node环境，所以就一定会有path模块，只是因为ts的语言特性，缺少了一些声明配置

所以需要安装关于node这个库的ts声明配置

```shell
npm i -D @types/node
```

安装成功就不会爆红了 如果import后面的path爆红，就把引入换成`import * as path from 'path'`

这之后我们就可以把@符号指代成src了 是绝对路径

## 5.2 配置路径别名的提示

虽然现在路径别名已经有了，但是在文件中输入@是没有提示路径的

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230623190032546.png" alt="image-20230623190032546" style="zoom:67%;" />

需要我们在`tsconfig.json`中添加两项配置

`src/tsconfig.json`

```json
    "baseUrl": "./",
    "paths": {
      "@/*": [
        "src/*"
      ]
    },
```

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230624144450710.png" alt="image-20230624144450710" style="zoom:67%;" />

这样就会有了提示

# 六、SCSS模块化

## 6.1 SCSS的进一步使用

在src下新建components文件夹

components文件夹下新建Comp1文件夹，新建index.tsx和comp1.scss

`src/components/Comp1/index.tsx`

```tsx
/*
 * @Author: czqczqzzzzzz(czq)
 * @Email: tenchenzhengqing@qq.com
 * @Date: 2023-06-24 14:48:58
 * @LastEditors: 陈正清MacPro
 * @LastEditTime: 2023-06-24 15:13:17
 * @FilePath: /react18+ts+vite后台管理系统/vite-project/src/components/Comp1/index.tsx
 * @Description: 测试组件Comp1
 * 
 * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved.
 */

// 引入当前文件夹下的样式
import './comp1.scss'  // 全局引入
function Comp1(){
    return (
        <div className="box">
            <p>这是Comp1组件里面的内容</p>
        </div>
    )
}

export default Comp1
```

`src/components/Comp1/index.scss`

```scss
.box {
    color: red;
}
```

components文件夹新建Comp2文件夹，新建index.tsx

`src/components/Comp2/index.tsx`

```tsx
/*
 * @Author: czqczqzzzzzz(czq)
 * @Email: tenchenzhengqing@qq.com
 * @Date: 2023-06-24 15:07:12
 * @LastEditors: 陈正清MacPro
 * @LastEditTime: 2023-06-24 15:10:48
 * @FilePath: /react18+ts+vite后台管理系统/vite-project/src/components/Comp2/index.tsx
 * @Description: 测试组件Comp2
 * 
 * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved.
 */
 
 //注意：在Comp2组件汇总不引入上面的comp1.scss样式
export default function Comp2() {
  return (
    <div className="box">
        <p>这是Comp2组件里面的内容</p>
    </div>
  )
}
```

在App.tsx注册这两个组件：

`src/App.tsx`

```tsx
import { useState } from 'react'
import Comp1 from './components/Comp1'
import Comp2 from './components/Comp2'

function App() {
  const [count, setCount] = useState(0)

  return (
    <div className='App'>
      顶级组件
      <Comp1></Comp1>
      <Comp2></Comp2>
    </div>
  )
}

export default App
```

## 6.2 SCSS的模块化

将comp1.scss改名为comp1.moudle.scss

`src/components/Comp1/index.tsx`

```tsx
// 引入当前文件夹下的样式
// import './comp1.scss'  // 全局引入

// scss模块化引入
import styles from './comp1.module.scss'
function Comp1(){
    return (
        <div className={styles.box}>
            <p>这是Comp1组件里面的内容</p>
        </div>
    )
}

export default Comp1
```

这个实现的效果就类似于vue中的style = scoped写法

`src/components/Comp1/comp1.moudle.scss`

```scss
.box {
    color: red;
    
    p {
        margin-top: 100px;
    }
}
```

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230624154319245.png" alt="image-20230624154319245" style="zoom:67%;" />

**！！注意：styles.box的box在.module.scss文件中只能是类名，标签名字不起作用**

# 七、AntDesign的初步引入

安装AntDesign

```shell
// 使用 npm 安装
npm install antd --save
// 使用 yarn 安装
yarn add antd
```

安装图标所需要的模块

```shell
// 使用 npm 安装
npm install --save @ant-design/icons
// 使用 yarn 安装
yarn add @ant-design/icons
```

在App组件中引入并使用

`src/App.tsx`

```tsx
/*
 * @Author: czqczqzzzzzz(czq)
 * @Email: tenchenzhengqing@qq.com
 * @Date: 2023-06-23 16:19:13
 * @LastEditors: 陈正清MacPro
 * @LastEditTime: 2023-06-24 16:14:07
 * @FilePath: /react18+ts+vite后台管理系统/vite-project/src/App.tsx
 * @Description: 所有组件的父组件App
 * 
 * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved.
 */
import { useState } from 'react'
import Comp1 from './components/Comp1'
import Comp2 from './components/Comp2'
import { Button } from 'antd'
import 'antd/dist/antd.css' // or 'antd/dist/antd.less'
import { FastBackwardOutlined } from '@ant-design/icons'

function App() {
  const [count, setCount] = useState(0)

  return (
    <div className='App'>
      顶级组件
      <Comp1></Comp1>
      <Comp2></Comp2>
      <Button type='primary'>Primary Button</Button>
      <FastBackwardOutlined style={{fontSize: '40px', color: '#08c'}} />
    </div>
  )
}

export default App

```

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230624162543224.png" alt="image-20230624162543224" style="zoom:67%;" />

# 八、配置Antd Design样式自动按需引入

antd的4.x版本以上已经支持按需引入，我们只需要解决样式上的自动按需引入即可

安装插件vite-plugin-style-import

```shell
npm install vite-plugin-style-import@1.4.1 -D
```

在vite.config.ts中进行配置

`src/vite.config.ts`

```ts
import styleImport,{AntdResolve} from 'vite-plugin-style-import';
export default defineConfig({
  plugins: [
    react(),
    styleImport({
      resolves: [
        AntdResolve()
      ],
    }),
  ],
  ...
})
```

然后我们就可以去掉App.tsx中的`import 'antd/dist/antd.css' // or 'antd/dist/antd.less' `这一行样式引入

启动项目，发现报错，缺少less，则我们开始安装less

```shell
npm i less@2.7.1 -D
```

这样就实现了按需引入antd，节省性能

# 九、React路由——第一种配置方案（旧项目中的写法）

## 9.1 初步展示

我们在这里模拟Vue中的Home和About两个组件的展示

1. 【准备界面】首先在src下创建views文件夹 然后准备两个目标组件

`src/views/Home.tsx`

```tsx
/*
 * @Author: czqczqzzzzzz(czq)
 * @Email: tenchenzhengqing@qq.com
 * @Date: 2023-06-24 18:15:11
 * @LastEditors: 陈正清MacPro
 * @LastEditTime: 2023-06-24 19:07:21
 * @FilePath: /react18+ts+vite后台管理系统/vite-project/src/views/Home.tsx
 * @Description: 路由写法 About组件
 * 
 * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved.
 */
const View = () => {
    return (
        <div className="home">
            <p>这是Home组件</p>
        </div>
    )
}

export default View
```

`src/views/Aboue.tsx`

```tsx
/*
 * @Author: czqczqzzzzzz(czq)
 * @Email: tenchenzhengqing@qq.com
 * @Date: 2023-06-24 18:15:11
 * @LastEditors: 陈正清MacPro
 * @LastEditTime: 2023-06-24 19:07:15
 * @FilePath: /react18+ts+vite后台管理系统/vite-project/src/views/About.tsx
 * @Description: 路由写法 Home组件
 * 
 * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved.
 */
const View = () => {
    return (
        <div className="home">
            <p>这是About组件</p>
        </div>
    )
}

export default View
```

2. 【配置对应关系】/src下新建router文件夹 再在里面创建index.tsx

`src/router/index.tsx`

```tsx
/*
 * @Author: czqczqzzzzzz(czq)
 * @Email: tenchenzhengqing@qq.com
 * @Date: 2023-06-24 18:18:16
 * @LastEditors: 陈正清MacPro
 * @LastEditTime: 2023-06-24 18:28:00
 * @FilePath: /react18+ts+vite后台管理系统/vite-project/src/router/index.tsx
 * @Description: React路由
 *
 * Copyright (c) by czqczqzzzzzz(czq), All Rights Reserved.
 */
import App from "@/App";
import Home from "@/views/Home";
import About from "@/views/About";
import { BrowserRouter, Routes, Route } from "react-router-dom";
// 两种路由模式的组件： BrowserRouter ( History模式 ) ， HashRouter( Hash模式 )


const router = () => {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<App />}>
          <Route path="/home" element={<Home />}></Route>
          <Route path="/about" element={<About />}></Route>
        </Route>
      </Routes>
    </BrowserRouter>
  );
};

export default router;
```

3. 【替换顶级组件】 在src/main.tsx中把顶级组件**App替换为这个路由对象**

```tsx
...
ReactDOM.createRoot(document.getElementById('root') as HTMLElement).render(
  <React.StrictMode>
    <Router />
  </React.StrictMode>,
)
```

4. 【添加窗口组件】/src/App.tsx中，使用组件Outlet作为占位符组件

`src/App.tsx`

```tsx
...
function App() {
  const [count, setCount] = useState(0)

  return (
    <div className='App'>
      {/* 顶级组件
      <Comp1></Comp1>
      <Comp2></Comp2>
      <Button type='primary'>Primary Button</Button>
      <FastBackwardOutlined style={{fontSize: '40px', color: '#08c'}} /> */}

      {/* 占位符组件 类似于窗口，用来展示组件 有点像Vue中的router-view */}
      <Outlet></Outlet>
    </div>
  )
}

export default App
```

这样在浏览器中访问对应的路由url 就能够看到路由组件了

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230624193022014.png" alt="image-20230624193022014" style="zoom:67%;" />

## 9.2 编程式导航——设置点击跳转

在App.tsx中，使用组件进行跳转

```tsx
import { Link, Outlet } from 'react-router-dom'

function App() {

  return (
    <div className='App'>
      <Link to='/home'>Home</Link>
      <Link to='/about'>About</Link>
      {/* 占位符组件 类似于窗口，用来展示组件 有点像Vue中的router-view */}
      <Outlet></Outlet>
    </div>
  )
}

export default App

```

这里我们使用到了link组件 类似于Vue中的router-link

<img src="/Users/chenzhengqing/Library/Application Support/typora-user-images/image-20230624194541287.png" alt="image-20230624194541287" style="zoom:67%;" />
